language: ruby
rvm:
  - rbx-2.5.2

before_install:
  - sudo apt-get install libmysql-ruby libmysqlclient-dev ruby-dev
  - gem install softwear-lib -i ~/.rvm/rubies/rbx-2.5.2/gems --no-ri --no-rdoc
  - wget http://chromedriver.storage.googleapis.com/2.15/chromedriver_linux64.zip
  - sudo unzip chromedriver_linux64.zip -d /usr/bin
  - rm chromedriver_linux64.zip

before_script:
  - |
    cat <<END >> config/database.yml
      test:
        adapter: mysql2
        database: crm-test
        username: travis
    END
  - bundle exec rake db:create
  - bundle exec rake db:migrate

script: xvfb-start bundle exec rspec -t ~solr
