language: ruby
rvm:
  - rbx-2.5.2

sudo: false

addons:
  apt:
    packages:
      - libmysql-ruby
      - libmysqlclient-dev
      - ruby-dev

before_install:
  - gem install softwear-lib -i ~/.rvm/rubies/rbx-2.5.2/gems --no-ri --no-rdoc
  - gem install eventmachine -i ~/.rvm/rubies/rbx-2.5.2/gems -v 1.0.3 --no-ri --no-rdoc

before_script:
  - |
    cat <<END >> config/database.yml
      test:
        adapter: mysql2
        database: crm_test
        username: travis
    END
  - bundle exec rake db:create
  - bundle exec rake db:schema:load

script: xvfb-run --server-args="-screen 0, 1024x768x24" bundle exec rspec -t ~no_ci
