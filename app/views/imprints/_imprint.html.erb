<% select_field_name_for = method(:imprint_select_field_name_for).to_proc.curry.(local_assigns[:imprint]) %>

<div class="col-sm-4 imprint-entry" data-id="<%= local_assigns[:imprint].try(:id) || increment_new_imprint_counter %>">
  <div class="box-info imprint-container">

  <% if ImprintMethod.all.empty? %>
    <p>
      Looks like there aren't any Imprint Methods registered. 
      <%= link_to "Click here", new_imprint_method_path %> to add one.
    </p>
  <% else %>
      <div class="print-location-container">
        <%= render partial: 'imprint_methods/print_locations_select',
                   locals: { print_locations: if local_assigns[:imprint_method]
                                                imprint_method.print_locations
                                              else
                                                ImprintMethod.first.print_locations
                                              end,

                             name: select_field_name_for.(:print_location_id),
                             default: local_assigns[:imprint].try(:print_location).try(:id) } %>
      </div>

      <div class="form-group">
        <%= label_tag :imprint_method %>
        <%= select_tag :imprint_method,
                       options_from_collection_for_select(
                         ImprintMethod.all,
                         :id,
                         :name,
                         local_assigns[:imprint_method].try(:id)
                       ),
                       id: "imprint_method_select_#{ local_assigns[:imprint].try(:id) }",
                       class: 'form-control js-imprint-method-select' %>
      </div>

      <div class="form-group checkbox-container">
        <%= label_tag "Name/Number Print?" %>

        <!-- TODO turn this into a helper function, perhaps -->
        <% checked = local_assigns[:imprint].try(:has_name_number) ? true : false %>
        <%= hidden_field_tag select_field_name_for.(:has_name_number), '0' %>
        <%= check_box_tag select_field_name_for.(:has_name_number), '1', checked, class: 'js-imprint-has-name-number' %>
      </div>

      <% if local_assigns[:imprint].try(:id) %>
      <div class="hidden" id="name_number_format_fields_<%= local_assigns[:imprint].id %>">
        <%= text_field_tag :name_format, local_assigns[:imprint].name_format %>
        <%= text_field_tag :number_format, local_assigns[:imprint].number_format %>
      </div>
      <% else %>
      <div class="hidden generic-error-message">
        Please click 'Update' before assigning names and numbers!
      </div>
      <% end %>

      <div class="full text-right">
        <%= link_to '#', class: 'js-delete-imprint-button' do %>
          <i class="fa fa-2x danger fa-times-circle"></i>
        <% end %>
      </div>

    <% end %>
  </div>
</div>